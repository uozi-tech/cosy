import{u as j,f as C,m as y,h as I,k as A}from"./useApi-C9wvGAhc.js";import{u as H,_ as M}from"./index-BG6BHNhw.js";import{f as W,h as E,S as Q,b as X,i as Y,j as J,k as K,a as L,P as T,T as U,Q as Z,y as ee,x as te,I as se,v as ae}from"./ant-design-vue-BZxoqjSI.js";import{d as ne,c as n,o as oe,b as le,Y as ue,X as m,k as t,W as s,V as re,u as e,l as g,$ as l,G as _}from"./vue-vendor-PlmX_NZX.js";const ie={class:"system-page"},ce={class:"mb-6"},me={class:"mt-2"},_e={class:"mt-2"},de={class:"mt-2 text-sm text-gray-500"},pe={class:"mt-2 text-sm text-gray-500"},ve=ne({__name:"System",setup(fe){const v=H(),{data:b,loading:O,execute:S}=j(),o=n(()=>b.value||{}),u=n(()=>v.systemStats&&Object.keys(v.systemStats).length>0?v.systemStats:b.value||{}),h=n(()=>u.value?.goroutine_stats?.active_count||o.value?.goroutines?.total||0),d=n(()=>{const a=o.value?.system_info||{};return{os:a.os||"Unknown",arch:a.arch||"Unknown",version:a.version||"Unknown",go_version:a.go_version||"Unknown",num_cpu:a.num_cpu||navigator?.hardwareConcurrency||0,num_goroutine:h.value}}),k=n(()=>u.value?.system_stats?.memory_usage||o.value?.memory?.alloc||0),x=n(()=>u.value?.system_stats?.cpu_usage||0),w=n(()=>{const a=o.value?.startup_time,p=o.value?.timestamp;return u.value?.system_stats?.uptime||(a&&p?p-a:0)}),q=n(()=>u.value?.goroutine_stats?.total_count||o.value?.goroutines?.total||0),F=n(()=>u.value?.request_stats?.total_requests||0),G=n(()=>u.value?.request_stats?.success_rate||0),N=n(()=>[{key:"memory_usage",name:"内存使用",value:C(k.value),type:"memory"},{key:"cpu_usage",name:"CPU使用率",value:`${x.value.toFixed(2)}%`,type:"percentage"},{key:"goroutines",name:"活跃协程数",value:y(h.value),type:"number"},{key:"uptime",name:"运行时间",value:I(w.value*1e3),type:"duration"},{key:"requests",name:"总请求数",value:y(F.value),type:"number"},{key:"success_rate",name:"成功率",value:`${G.value.toFixed(2)}%`,type:"percentage"},{key:"gc_count",name:"GC次数",value:y(o.value?.memory?.num_gc||0),type:"number"}]),P=[{title:"指标",dataIndex:"name",key:"name",width:200},{title:"当前值",dataIndex:"value",key:"value",width:200}];oe(async()=>{await S()});const z=setInterval(async()=>{v.isConnected||await S()},3e4);return le(()=>{clearInterval(z)}),(a,p)=>{const B=Q,V=W,f=K,r=J,i=Y,D=E,c=te,$=ee,R=ae;return re(),ue("div",ie,[m("div",ce,[t(V,{level:2,class:"mb-4"},{default:s(()=>[t(B,null,{default:s(()=>[t(e(X)),p[0]||(p[0]=m("span",null,"系统信息",-1))]),_:1})]),_:1})]),t(D,{gutter:[24,24],class:"mb-6"},{default:s(()=>[t(i,{xs:24,sm:12,lg:6},{default:s(()=>[t(r,null,{default:s(()=>[t(f,{title:"内存使用",value:e(C)(e(k)),prefix:("h"in a?a.h:e(g))(e(L),{style:{color:"#722ed1"}})},null,8,["value","prefix"]),m("div",me,[t(e(T),{percent:Math.min(parseFloat((e(k)/(1024*1024*1024*8)*100).toFixed(2)),100),size:"small","stroke-color":"#722ed1",style:{width:"100%"}},null,8,["percent"])])]),_:1})]),_:1}),t(i,{xs:24,sm:12,lg:6},{default:s(()=>[t(r,null,{default:s(()=>[t(f,{title:"CPU使用率",value:`${e(x).toFixed(2)}%`,prefix:("h"in a?a.h:e(g))(e(U),{style:{color:"#faad14"}})},null,8,["value","prefix"]),m("div",_e,[t(e(T),{percent:e(x),size:"small","stroke-color":"#faad14"},null,8,["percent"])])]),_:1})]),_:1}),t(i,{xs:24,sm:12,lg:6},{default:s(()=>[t(r,null,{default:s(()=>[t(f,{title:"活跃协程",value:e(h),prefix:("h"in a?a.h:e(g))(e(U),{style:{color:"#1890ff"}})},null,8,["value","prefix"]),m("div",de," 总计: "+l(e(y)(e(q))),1)]),_:1})]),_:1}),t(i,{xs:24,sm:12,lg:6},{default:s(()=>[t(r,null,{default:s(()=>[t(f,{title:"运行时间",value:e(I)(e(w)*1e3),prefix:("h"in a?a.h:e(g))(e(Z),{style:{color:"#52c41a"}})},null,8,["value","prefix"]),m("div",pe," 启动时间: "+l(e(A)(e(o).startup_time||Date.now())),1)]),_:1})]),_:1})]),_:1}),t(D,{gutter:[24,24]},{default:s(()=>[t(i,{xs:24,lg:12},{default:s(()=>[t(r,{title:"系统信息"},{extra:s(()=>[t(e(se))]),default:s(()=>[t($,{column:1,size:"small"},{default:s(()=>[t(c,{label:"操作系统"},{default:s(()=>[_(l(e(d).os)+" "+l(e(d).version),1)]),_:1}),t(c,{label:"系统架构"},{default:s(()=>[_(l(e(d).arch),1)]),_:1}),t(c,{label:"Go版本"},{default:s(()=>[_(l(e(d).go_version),1)]),_:1}),t(c,{label:"CPU核心数"},{default:s(()=>[_(l(e(d).num_cpu),1)]),_:1}),t(c,{label:"启动时间"},{default:s(()=>[_(l(e(A)(e(o).startup_time||Date.now())),1)]),_:1}),t(c,{label:"进程 ID"},{default:s(()=>[_(l(e(o).pid||"N/A"),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(i,{xs:24,lg:12},{default:s(()=>[t(r,{title:"运行时统计"},{default:s(()=>[t(R,{columns:P,"data-source":e(N),pagination:!1,loading:e(O),size:"small","row-key":"key"},null,8,["data-source","loading"])]),_:1})]),_:1})]),_:1})])}}}),xe=M(ve,[["__scopeId","data-v-6223e335"]]);export{xe as default};

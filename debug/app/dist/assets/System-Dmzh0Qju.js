import{u as j,f as C,m as f,h as I,k as A}from"./useApi-Ci9ikep3.js";import{u as H,_ as M}from"./index-C3c8jOCC.js";import{f as W,h as E,S as Q,b as X,i as Y,j as J,k as K,a as L,P as T,T as U,Q as Z,x as ee,w as te,I as ae,u as se}from"./ant-design-vue-DhOu_vW1.js";import{d as ne,c as n,o as oe,b as le,Y as ue,X as _,k as t,W as a,V as re,u as e,l as y,$ as l,G as d}from"./vue-vendor-CHXvf8H0.js";const ce={class:"system-page"},ie={class:"mb-6"},me={class:"mt-2"},_e={class:"mt-2"},de={class:"mt-2 text-sm text-gray-500"},pe={class:"mt-2 text-sm text-gray-500"},ve=ne({__name:"System",setup(fe){const x=H(),{data:b,loading:O,execute:w}=j(),o=n(()=>b.value||{}),u=n(()=>{const s=e(x.systemStats);return s&&Object.keys(s).length>0?s:b.value||{}}),g=n(()=>u.value?.goroutine_stats?.active_count||o.value?.goroutines?.total||0),p=n(()=>{const s=o.value?.system_info||{};return{os:s.os||"Unknown",arch:s.arch||"Unknown",version:s.version||"Unknown",go_version:s.go_version||"Unknown",num_cpu:s.num_cpu||navigator?.hardwareConcurrency||0,num_goroutine:g.value}}),h=n(()=>u.value?.system_stats?.memory_usage||o.value?.memory?.alloc||0),k=n(()=>u.value?.system_stats?.cpu_usage||0),S=n(()=>{const s=o.value?.startup_time,r=o.value?.timestamp;return u.value?.system_stats?.uptime||(s&&r?r-s:0)}),q=n(()=>u.value?.goroutine_stats?.total_count||o.value?.goroutines?.total||0),F=n(()=>u.value?.request_stats?.total_requests||0),G=n(()=>u.value?.request_stats?.success_rate||0),N=n(()=>[{key:"memory_usage",name:"内存使用",value:C(h.value),type:"memory"},{key:"cpu_usage",name:"CPU使用率",value:`${k.value.toFixed(2)}%`,type:"percentage"},{key:"goroutines",name:"活跃协程数",value:f(g.value),type:"number"},{key:"uptime",name:"运行时间",value:I(S.value*1e3),type:"duration"},{key:"requests",name:"总请求数",value:f(F.value),type:"number"},{key:"success_rate",name:"成功率",value:`${G.value.toFixed(2)}%`,type:"percentage"},{key:"gc_count",name:"GC次数",value:f(o.value?.memory?.num_gc||0),type:"number"}]),P=[{title:"指标",dataIndex:"name",key:"name",width:200},{title:"当前值",dataIndex:"value",key:"value",width:200}];oe(async()=>{await w()});const z=setInterval(async()=>{x.isConnected||await w()},3e4);return le(()=>{clearInterval(z)}),(s,r)=>{const B=Q,V=W,v=K,c=J,i=Y,D=E,m=te,$=ee,R=se;return re(),ue("div",ce,[_("div",ie,[t(V,{level:2,class:"mb-4"},{default:a(()=>[t(B,null,{default:a(()=>[t(e(X)),r[0]||(r[0]=_("span",null,"系统信息",-1))]),_:1})]),_:1})]),t(D,{gutter:[24,24],class:"mb-6"},{default:a(()=>[t(i,{xs:24,sm:12,lg:6},{default:a(()=>[t(c,null,{default:a(()=>[t(v,{title:"内存使用",value:e(C)(e(h)),prefix:("h"in s?s.h:e(y))(e(L),{style:{color:"#722ed1"}})},null,8,["value","prefix"]),_("div",me,[t(e(T),{percent:Math.min(parseFloat((e(h)/(1024*1024*1024*8)*100).toFixed(2)),100),size:"small","stroke-color":"#722ed1",style:{width:"100%"}},null,8,["percent"])])]),_:1})]),_:1}),t(i,{xs:24,sm:12,lg:6},{default:a(()=>[t(c,null,{default:a(()=>[t(v,{title:"CPU使用率",value:`${e(k).toFixed(2)}%`,prefix:("h"in s?s.h:e(y))(e(U),{style:{color:"#faad14"}})},null,8,["value","prefix"]),_("div",_e,[t(e(T),{percent:e(k),size:"small","stroke-color":"#faad14"},null,8,["percent"])])]),_:1})]),_:1}),t(i,{xs:24,sm:12,lg:6},{default:a(()=>[t(c,null,{default:a(()=>[t(v,{title:"活跃协程",value:e(g),prefix:("h"in s?s.h:e(y))(e(U),{style:{color:"#1890ff"}})},null,8,["value","prefix"]),_("div",de," 总计: "+l(e(f)(e(q))),1)]),_:1})]),_:1}),t(i,{xs:24,sm:12,lg:6},{default:a(()=>[t(c,null,{default:a(()=>[t(v,{title:"运行时间",value:e(I)(e(S)*1e3),prefix:("h"in s?s.h:e(y))(e(Z),{style:{color:"#52c41a"}})},null,8,["value","prefix"]),_("div",pe," 启动时间: "+l(e(A)(e(o).startup_time||Date.now())),1)]),_:1})]),_:1})]),_:1}),t(D,{gutter:[24,24]},{default:a(()=>[t(i,{xs:24,lg:12},{default:a(()=>[t(c,{title:"系统信息"},{extra:a(()=>[t(e(ae))]),default:a(()=>[t($,{column:1,size:"small"},{default:a(()=>[t(m,{label:"操作系统"},{default:a(()=>[d(l(e(p).os)+" "+l(e(p).version),1)]),_:1}),t(m,{label:"系统架构"},{default:a(()=>[d(l(e(p).arch),1)]),_:1}),t(m,{label:"Go版本"},{default:a(()=>[d(l(e(p).go_version),1)]),_:1}),t(m,{label:"CPU核心数"},{default:a(()=>[d(l(e(p).num_cpu),1)]),_:1}),t(m,{label:"启动时间"},{default:a(()=>[d(l(e(A)(e(o).startup_time||Date.now())),1)]),_:1}),t(m,{label:"进程 ID"},{default:a(()=>[d(l(e(o).pid||"N/A"),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(i,{xs:24,lg:12},{default:a(()=>[t(c,{title:"运行时统计"},{default:a(()=>[t(R,{columns:P,"data-source":e(N),pagination:!1,loading:e(O),size:"small","row-key":"key"},null,8,["data-source","loading"])]),_:1})]),_:1})]),_:1})])}}}),xe=M(ve,[["__scopeId","data-v-db0ea5c7"]]);export{xe as default};
